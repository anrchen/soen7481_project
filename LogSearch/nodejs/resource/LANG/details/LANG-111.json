{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12340679","self":"https://issues.apache.org/jira/rest/api/2/issue/12340679","key":"LANG-111","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310481","id":"12310481","key":"LANG","name":"Commons Lang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310481&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310481&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310481&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310481&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10260","id":"10260","description":"Apache Commons components","name":"Commons"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311706","id":"12311706","description":"","name":"2.0","archived":true,"released":true,"releaseDate":"2003-09-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2003-04-30T02:52:33.000+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Jun 09 06:18:52 UTC 2003","customfield_12310420":"147059","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":"2006-05-16T12:40:25.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-111/watchers","watchCount":0,"isWatching":false},"created":"2003-04-27T21:49:50.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311706","id":"12311706","description":"","name":"2.0","archived":true,"released":true,"releaseDate":"2003-09-02"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-05-16T12:40:25.000+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"The time unit tests fail when run on a Sunday:\n\ntest.time:\n     [echo] Running time package tests ...\n     [java] ...F.F................\n     [java] Time: 4.394\n     [java] There were 2 failures:\n     [java] 1)\ntestParse(org.apache.commons.lang.time.CalendarUtilsTest)junit.framework.AssertionFailedError:\nparse last Sunday expected Sun Apr 27 06:39:17 MST 2003 but got Sun Apr 20\n06:39:17 MST 2003\n     [java] \tat\norg.apache.commons.lang.time.CalendarUtilsTest.assertEquals(CalendarUtilsTest.java:373)\n     [java] \tat\norg.apache.commons.lang.time.CalendarUtilsTest.testParse(CalendarUtilsTest.java:243)\n     [java] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     [java] \tat\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n     [java] \tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n     [java] 2)\ntestWeekIterator(org.apache.commons.lang.time.CalendarUtilsTest)junit.framework.AssertionFailedError:\n expected Mon Apr 28 00:00:00 MST 2003 but got Mon Apr 21 00:00:00 MST 2003\n     [java] \tat\norg.apache.commons.lang.time.CalendarUtilsTest.assertEquals(CalendarUtilsTest.java:373)\n     [java] \tat\norg.apache.commons.lang.time.CalendarUtilsTest.assertWeekIterator(CalendarUtilsTest.java:346)\n     [java] \tat\norg.apache.commons.lang.time.CalendarUtilsTest.assertWeekIterator(CalendarUtilsTest.java:324)\n     [java] \tat\norg.apache.commons.lang.time.CalendarUtilsTest.testWeekIterator(CalendarUtilsTest.java:284)\n     [java] \tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n     [java] \tat\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)\n     [java] \tat\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)\n\nLooks to me like the unit test code is checking the value of Calendar.DATE, when\nit should be looking at Calendar.DAY_OF_WEEK (at line 237 and below) to decide\nwhether to make adjustments for today==Sunday.\n\nWhen I fix this, testParse succeeds but testWeekIterator hangs at the statement\nit = CalendarUtils.getCalendarIterator(now, CalendarUtils.RANGE_WEEK_RELATIVE);","customfield_10010":19364.0,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12332241","id":"12332241","filename":"ASF.LICENSE.NOT.GRANTED--CalendarUtilsTestPatch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phil%40steitz.com","name":"phil@steitz.com","key":"phil@steitz.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"created":"2003-05-24T11:04:13.000+0000","size":3502,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12332241/ASF.LICENSE.NOT.GRANTED--CalendarUtilsTestPatch.txt"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12332240","id":"12332240","filename":"ASF.LICENSE.NOT.GRANTED--Patch.txt","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohankishore%40yahoo.com","name":"mohankishore@yahoo.com","key":"mohankishore@yahoo.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohan Kishore","active":true,"timeZone":"Etc/UTC"},"created":"2003-04-30T03:30:40.000+0000","size":2154,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12332240/ASF.LICENSE.NOT.GRANTED--Patch.txt"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"74864","customfield_12312823":null,"summary":"[Lang] time unit tests fail on Sundays","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phil%40steitz.com","name":"phil@steitz.com","key":"phil@steitz.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phil%40steitz.com","name":"phil@steitz.com","key":"phil@steitz.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Operating System: other\nPlatform: Other","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340679/comment/12404154","id":"12404154","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohankishore%40yahoo.com","name":"mohankishore@yahoo.com","key":"mohankishore@yahoo.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohan Kishore","active":true,"timeZone":"Etc/UTC"},"body":"Just a note, the CalendarUtils.getCalendarIterator(now, \nCalendarUtils.RANGE_WEEK_RELATIVE) hangs irrespective of the changes to the \ntest-case. i.e. it will always hang if run on a sunday.\n\nIt is just getting highlighted as currently, the assert just ahead of it fails \non sundays. Hence, either everything runs fine, or the (unrelated) assert in \nfront of it fails.\n\nAs suggested, there are 2 places currently which need to be \nCalendar.DAY_OF_WEEK and not DATE. The RANGE_WEEK_RELATIVE logic needs to be \ninvestigated.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohankishore%40yahoo.com","name":"mohankishore@yahoo.com","key":"mohankishore@yahoo.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohan Kishore","active":true,"timeZone":"Etc/UTC"},"created":"2003-04-30T02:52:33.000+0000","updated":"2003-04-30T02:52:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340679/comment/12404155","id":"12404155","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohankishore%40yahoo.com","name":"mohankishore@yahoo.com","key":"mohankishore@yahoo.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohan Kishore","active":true,"timeZone":"Etc/UTC"},"body":"Created an attachment (id=6081)\nDATE to DAY_OF_WEEK, in test-case and minor fix in CalendarUtils\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=mohankishore%40yahoo.com","name":"mohankishore@yahoo.com","key":"mohankishore@yahoo.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Mohan Kishore","active":true,"timeZone":"Etc/UTC"},"created":"2003-04-30T03:30:40.000+0000","updated":"2003-04-30T03:30:40.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340679/comment/12404156","id":"12404156","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phil%40steitz.com","name":"phil@steitz.com","key":"phil@steitz.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"body":"I am attaching another patch to CalendarUtilsTest.java that runs\ntestWeekIterator() in a loop, incrementing the reference date in a loop to hit\nall days of the week.\n\nThis patch also fixes the error in the test identified above (Calendar.DATE\nshould be Calendar.DAY_OF_WEEK) in two places.  \n\nApplying this patch will cause the test to hang, since it exposes the\nCalendarUtils bug identified (and patched) by Mohan above.  This bug causes\ngetCalendarIterator(Calendar focus, int rangeStyle) to go into an infinite loop\nwhen focus is a Sunday and rangeStyle is RANGE_WEEK_RELATIVE.  Mohan's patch to\nCalendarUtils handles the boundary cases.  When it is applied, all tests,\n(including the loop addition) succeed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phil%40steitz.com","name":"phil@steitz.com","key":"phil@steitz.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"created":"2003-05-24T11:02:40.000+0000","updated":"2003-05-24T11:02:40.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340679/comment/12404157","id":"12404157","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phil%40steitz.com","name":"phil@steitz.com","key":"phil@steitz.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"body":"Created an attachment (id=6476)\npatch to run testWeekIterator in a loop over start days\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=phil%40steitz.com","name":"phil@steitz.com","key":"phil@steitz.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"created":"2003-05-24T11:04:13.000+0000","updated":"2003-05-24T11:04:13.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340679/comment/12404158","id":"12404158","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne%40joda.org","name":"scolebourne@joda.org","key":"scolebourne@joda.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Etc/UTC"},"body":"All patches applied, plus many other changes in time package.\nThanks for the patches.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne%40joda.org","name":"scolebourne@joda.org","key":"scolebourne@joda.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Etc/UTC"},"created":"2003-06-09T06:18:52.000+0000","updated":"2003-06-09T06:18:52.000+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-111/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0d6pr:"}}