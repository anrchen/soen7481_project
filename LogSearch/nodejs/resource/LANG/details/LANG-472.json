{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12409241","self":"https://issues.apache.org/jira/rest/api/2/issue/12409241","key":"LANG-472","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310481","id":"12310481","key":"LANG","name":"Commons Lang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310481&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310481&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310481&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310481&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10260","id":"10260","description":"Apache Commons components","name":"Commons"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12314743","id":"12314743","description":"","name":"2.5","archived":true,"released":true,"releaseDate":"2010-02-25"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2008-11-26T03:49:27.295+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sat Feb 06 02:42:17 UTC 2010","customfield_12310420":"147340","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_37753888460_*|*_5_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2010-02-06T02:42:17.201+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-472/watchers","watchCount":0,"isWatching":false},"created":"2008-11-26T03:30:48.741+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2010-03-03T09:34:30.251+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313200","id":"12313200","name":"lang.math.*"}],"timeoriginalestimate":null,"description":"when we use the following code , we can see that the method produce only even number.\n\n         while (true) {\n//        for (int i = 0; i < 100; i++) {\n            if (RandomUtils.nextLong() % 2 == 1) {\n                System.out.println(\"ok\");\n            }\n        }","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12394857","id":"12394857","filename":"lang-472.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=psteitz","name":"psteitz","key":"psteitz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-27T17:25:42.816+0000","size":1936,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12394857/lang-472.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12434774","id":"12434774","filename":"LANG-472-alt.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=niallp","name":"niallp","key":"niallp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niall Pemberton","active":true,"timeZone":"Etc/UTC"},"created":"2010-02-04T02:47:16.314+0000","size":2313,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12434774/LANG-472-alt.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"74737","customfield_12312823":null,"summary":"RandomUtils.nextLong() get all even number","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kaqi072821","name":"kaqi072821","key":"kaqi072821","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhangruimin","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=kaqi072821","name":"kaqi072821","key":"kaqi072821","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"zhangruimin","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"all system","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12650856","id":"12650856","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jwcarman","name":"jwcarman","key":"jwcarman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Carman","active":true,"timeZone":"Etc/UTC"},"body":"So, you're saying you never see an \"ok\"?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jwcarman","name":"jwcarman","key":"jwcarman","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"James Carman","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-26T03:49:27.295+0000","updated":"2008-11-26T03:49:27.295+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12651396","id":"12651396","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=psteitz","name":"psteitz","key":"psteitz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"body":"Looks like this is due to loss of significance in the multiply (per the comment ;)\n\nAttached patch replaces the impl with the JDK-supplied method, maintaining the (undocumented) non-negative behavior.  Added test confirms that returned values are evenly distributed mod 2. \n\nThis problem also affects nextLong(n) where n is sufficiently large.  We should either replace the implementation with something else that works for large values of n or determine and document the upper bound.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=psteitz","name":"psteitz","key":"psteitz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-27T17:25:42.851+0000","updated":"2008-11-27T17:25:42.851+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12651431","id":"12651431","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=psteitz","name":"psteitz","key":"psteitz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"body":"Just realized that the patch violates / changes the contract of JVMRandom (as I understand it).  If we want to maintain the static, single-underlying-Random behavior, we would need to create a static random instance and use that instance's nextLong() method in place of super.nextLong() in the patch.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=psteitz","name":"psteitz","key":"psteitz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Phil Steitz","active":true,"timeZone":"Etc/UTC"},"created":"2008-11-27T23:12:42.698+0000","updated":"2008-11-27T23:12:42.698+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12677876","id":"12677876","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"I'm not tied to JVMRandom. I needed it for a particular set of code, but haven't used it since.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-03-02T02:43:22.163+0000","updated":"2009-03-02T02:43:22.163+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12704486","id":"12704486","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"JVMRandom is removed for 3.0, along with RandomUtils, so making this a 2.x issue.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-04-30T05:49:26.078+0000","updated":"2009-04-30T05:49:26.078+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12829378","id":"12829378","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"body":"Applied Phil's patch, but adjusted so that the class now uses a static Random() instance for all random number generation.\n\nURL: http://svn.apache.org/viewvc?rev=906318&view=rev\nLog:\nLANG-472 - RandomUtils.nextLong() get all even number\n\nModified:\n   commons/proper/lang/branches/LANG_2_X/src/main/java/org/apache/commons/lang/math/JVMRandom.java\n   commons/proper/lang/branches/LANG_2_X/src/test/java/org/apache/commons/lang/math/RandomUtilsTest.java\n\nI suspect nextLong(long) probably does not generate very evenly distributed numbers.\n\nAlso documented non-negative behaviour:\n\nURL: http://svn.apache.org/viewvc?rev=906319&view=rev\nLog:\nLANG-472 - Document >=0 behaviour\n\nModified:\n   commons/proper/lang/branches/LANG_2_X/src/main/java/org/apache/commons/lang/math/JVMRandom.java\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"created":"2010-02-04T01:39:24.916+0000","updated":"2010-02-04T01:39:24.916+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12829407","id":"12829407","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=niallp","name":"niallp","key":"niallp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niall Pemberton","active":true,"timeZone":"Etc/UTC"},"body":"Alternative patch which just fixes the issue when n is Long.MAX_VALUE","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=niallp","name":"niallp","key":"niallp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niall Pemberton","active":true,"timeZone":"Etc/UTC"},"created":"2010-02-04T02:47:16.357+0000","updated":"2010-02-04T02:47:16.357+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12829408","id":"12829408","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=niallp","name":"niallp","key":"niallp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niall Pemberton","active":true,"timeZone":"Etc/UTC"},"body":"Doh! Sorry didn't see Sebb had already fixed this - ignore me","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=niallp","name":"niallp","key":"niallp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niall Pemberton","active":true,"timeZone":"Etc/UTC"},"created":"2010-02-04T02:49:50.501+0000","updated":"2010-02-04T02:49:50.501+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12829424","id":"12829424","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=niallp","name":"niallp","key":"niallp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niall Pemberton","active":true,"timeZone":"Etc/UTC"},"body":"Just reviewed Sebb's change - RandomUtils.nextLong() is now fixed because it no longer calls JVMRandom nextLong(Long.MAX_VALUE) - but instead delagates to SHARED_RANDOM.nextLong(). AFAICS calling JVMRandom nextLong(Long.MAX_VALUE)  will still see the same problem.\n\nDo we want to do anything about this (my nasty hack?)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=niallp","name":"niallp","key":"niallp","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Niall Pemberton","active":true,"timeZone":"Etc/UTC"},"created":"2010-02-04T03:49:08.996+0000","updated":"2010-02-04T03:49:08.996+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12829431","id":"12829431","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"body":"[Actually it was Phil's patch, amended to use the shared static Random instance.]\n\nOne could also use Phil's solution and put:\n\n{code}\nif (n == Long.MAX_VALUE) {\n    return Math.abs(SHARED_RANDOM.nextLong());\n}\n{code}\n\nHowever, that only fixes the one value - as far as I can tell, nextLong(long) starts failing tests at around Long.MAX_VALUE/920 (not that there are any tests in SVN yet!)\n\nBTW, I think your hack would be more efficient as\n\n{code}\nif (n == Long.MAX_VALUE) {\n    double random = -1;\n    while (random < 0) {\n        random = Math.random();\n    }\n    return new BigDecimal(random).movePointRight(19).longValue();\n}\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"created":"2010-02-04T04:24:24.437+0000","updated":"2010-02-04T04:24:24.437+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12829592","id":"12829592","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"body":"It's just occurred to me that using Math.abs() to ensure non-negative numbers means that the value 0 will appear with half the expected freqency.\n\nSo maybe looping whilst looking for a non-negative number would be a better solution (let's hope any run of negative numbers is not too long!)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"created":"2010-02-04T12:05:21.282+0000","updated":"2010-02-04T12:05:21.282+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12829634","id":"12829634","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"body":"Just realised that nextInt() will never return Integer.MAX_VALUE. \nShould it?\n\nIf so, then maybe the way to do this is:\n\n{code}\nint random=SHARED_RANDOM.nextInt();\nif (random == Integer.MIN_VALUE) {\n    random = 0; // should solve problem of reduced frequency of 0\n} else {\n    random = - random;\n}\n{code}\n\nCould use the same approach for nextLong()\n\nThoughts?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"created":"2010-02-04T16:14:10.602+0000","updated":"2010-02-04T16:14:10.602+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12829827","id":"12829827","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"body":"Math.abs() can return a negative number if parameter is MIN_VALUE.\nReplacing this with 0 makes it non-negative and solves problem of reduced frequency of zero.\n\nApplied to nextInt() and nextLong():\n\nURL: http://svn.apache.org/viewvc?rev=906693&view=rev\nLog:\nMath.abs(long) can return a negative number\nFix nextInt() and nextLong() so all values 0 -> MAX_VALUE are equally likely\n\nI think the only remaining problem is the method nextLong(long) does not generate properly distributed numbers above about Long.MAX_VALUE/1000, possibly lower.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"created":"2010-02-04T22:39:41.225+0000","updated":"2010-02-04T22:39:41.225+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12409241/comment/12830434","id":"12830434","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"body":"The behaviour of nextLong(long) has been fixed by adapting the nextInt(int) code from Harmony's Random class:\n\nURL: http://svn.apache.org/viewvc?rev=907160&view=rev\nLog:\nRevert nextInt() and nextLong() to 2.4 behaviour, i.e MAX_VALUE is not included\nRewrite nextLong(long) based on Harmony's implementation of nextInt(int)\n\nModified:\n   commons/proper/lang/branches/LANG_2_X/src/main/java/org/apache/commons/lang/math/JVMRandom.java","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"created":"2010-02-06T02:42:17.065+0000","updated":"2010-02-06T02:42:17.065+0000"}],"maxResults":14,"total":14,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-472/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0d5xj:"}}