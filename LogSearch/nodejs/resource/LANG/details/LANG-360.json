{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12380853","self":"https://issues.apache.org/jira/rest/api/2/issue/12380853","key":"LANG-360","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310481","id":"12310481","key":"LANG","name":"Commons Lang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310481&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310481&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310481&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310481&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10260","id":"10260","description":"Apache Commons components","name":"Commons"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312481","id":"12312481","description":"Bugfix release of the Lang1 codebase","name":"2.4","archived":true,"released":true,"releaseDate":"2008-03-18"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2007-10-30T04:25:31.707+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Nov 12 22:54:23 UTC 2007","customfield_12310420":"34122","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_1938694439_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2007-11-12T22:54:23.439+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-360/watchers","watchCount":0,"isWatching":false},"created":"2007-10-21T12:22:49.482+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2007-11-12T22:54:23.436+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"ObjectUtils is designed to handle null imputs gracefully. But ObjectUtils.appendIdentityToString does not. It returns null unnessecary if you pass null als second parameter (the object to get the identity from). For example appendIdentityToString(new StringBuffer(), null) will return null! Which is an uncommen behaviour. Think about code like this:\n\nObjectUtils.appendIdentityToString(buffer, param1)\n                    .appendIdentityToString(buffer, param2)\n                    .appendIdentityToString(buffer, param3);\n\nThis will cause an NPE if param1 or param2 ist null. There may be other code where a NPE will not happen, but the code is used for debugging and there will be an unexpected or wrong output.\n\nSo you shoul return the StringBuffer which is passed in or a new one if null. The harder question is what to do with the object. I think we should append \"null\" to the StringBuffer, because this is what I would expect and what the passed reference is.\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12369392","id":"12369392","filename":"LANG-360.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-11-12T20:23:14.933+0000","size":3635,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12369392/LANG-360.patch"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12368920","id":"12368920","filename":"LANG-360.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-11-03T08:01:00.926+0000","size":4778,"mimeType":"text/x-patch","content":"https://issues.apache.org/jira/secure/attachment/12368920/LANG-360.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"74779","customfield_12312823":null,"summary":"Why does appendIdentityToString return null?","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jogi","name":"jogi","key":"jogi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jörg Gottschling","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jogi","name":"jogi","key":"jogi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jörg Gottschling","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12538659","id":"12538659","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Definitely agreed that I wouldn't expect the chained style to fail just because null was passed into it.\n\nA StringBuffer with \"null\" in seems to make more sense than an empty StringBuffer. \n\nSo +1 to both suggestions, and we just need to decide if we're happy making this change in 2.4.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-30T04:25:31.707+0000","updated":"2007-10-30T04:25:31.707+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12538664","id":"12538664","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pbenedict","name":"pbenedict","key":"pbenedict","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10453"},"displayName":"pbenedict","active":false,"timeZone":"Etc/UTC"},"body":"What's ironic is that the current behavior is in perfect line with the javadoc:\n\n\"Appends the toString that would be produced by Object  if a class did not override toString itself. null  will return null. ObjectUtils.appendIdentityToString(*, null) = null\"\n\nBased on that, it's difficult to argue that the current behavior is incorrect. Almost all of Commons Lang behavior returns null where possible for a null source parameter.\n\nI recommend keeping the current behavior, but adding a second method that combines appendIdentityToString and defaultIfNull: \n\nappendIdentityToString(StringBuffer buffer, Object object, Object defaultValue)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pbenedict","name":"pbenedict","key":"paul4christ79","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=paul4christ79&avatarId=37065","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=paul4christ79&avatarId=37065","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=paul4christ79&avatarId=37065","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=paul4christ79&avatarId=37065"},"displayName":"Paul Benedict","active":true,"timeZone":"America/Chicago"},"created":"2007-10-30T05:06:21.978+0000","updated":"2007-10-30T05:06:21.978+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12538682","id":"12538682","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jogi","name":"jogi","key":"jogi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jörg Gottschling","active":true,"timeZone":"Etc/UTC"},"body":"Yes, this behavior is in sync with the javadoc. That's where I found it first. But that did not mean that it is a good behavior.\n\nI like to vote against a second method with a default value. Who needs a default value, when debugging an object? (If this bean is null, log another one?) A method appendIdentityToStringNullSave would be better, but a little ugly.\n\n>> Almost all of Commons Lang behavior returns null where possible for a null source parameter.  <<\n\nHm, I don't think so. And evan if it would be: Returning null, if the StringBuffer is null could be argued, but returning null if the second value is null is definitly a bad behavior. Remember this:\n   appendIdentityToString(new StringBuffer(), null)  \nWould you expect this to return null? But this does not return null:\n   appendIdentityToString(null, new Object())\nReally confusing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jogi","name":"jogi","key":"jogi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jörg Gottschling","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-30T06:53:24.397+0000","updated":"2007-10-30T06:54:18.337+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12538690","id":"12538690","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bens","name":"bens","key":"bens","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben Speakmon","active":true,"timeZone":"Etc/UTC"},"body":"It's unfortunate that the API here forces the user to null-protect his parameters to it. I think it's clear that the better choice would have been to simply append \"null\", since that is the toString() value of the null reference according to the JLS. That said, it is documented to work the way it does, and that makes it not wrong but simply annoying.\n\n+1 to Paul's idea and having a similarly named method with another parameter with a default value. Maybe we should also deprecate the current one for 2.4 with a warning explaining this problem.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bens","name":"bens","key":"bens","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben Speakmon","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-30T07:35:49.054+0000","updated":"2007-10-30T07:35:49.054+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12538790","id":"12538790","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pbenedict","name":"pbenedict","key":"pbenedict","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10453"},"displayName":"pbenedict","active":false,"timeZone":"Etc/UTC"},"body":"After some further ruminations, I favor deprecating the current method (Ben's comment) but also coming up with a new name that corrects the behavior. Throwing in a third parameter is quite ugly and not necessary. Perhaps we can call it simply \"appendIdentity\" ? Funny that the current method is \"ToString\" when it really appends to a StringBuffer, not a String ;-)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pbenedict","name":"pbenedict","key":"paul4christ79","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=paul4christ79&avatarId=37065","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=paul4christ79&avatarId=37065","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=paul4christ79&avatarId=37065","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=paul4christ79&avatarId=37065"},"displayName":"Paul Benedict","active":true,"timeZone":"America/Chicago"},"created":"2007-10-30T14:44:01.853+0000","updated":"2007-10-30T14:44:01.853+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12538796","id":"12538796","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"+1 on 'appendIdentity'.\n\nI also don't like the first parameter being nullable. There should be a version without that. \n\nappendIdentity(Object obj);StringBuffer\nappendIdentity(Object obj, StringBuffer buffer);StringBuffer\n\nThe downside is that that means making it the second parameter. It's a clash between the API rules that 'the target should come first' and 'optional parameters should be on the end'. An optional target is just odd :)\n\nMaybe:\n\nappendIdentityToNewBuffer(Object obj);StringBuffer\nappendIdentity(StringBuffer buffer, Object obj);StringBuffer\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-10-30T15:11:33.100+0000","updated":"2007-10-30T15:11:33.100+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12538844","id":"12538844","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jogi","name":"jogi","key":"jogi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jörg Gottschling","active":true,"timeZone":"Etc/UTC"},"body":">> Perhaps we can call it simply \"appendIdentity\" ? Funny that the current method is \"ToString\" when it really appends to a StringBuffer, not a String ;-) <<\n\n:-)   +1 on that!","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jogi","name":"jogi","key":"jogi","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jörg Gottschling","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-30T16:42:11.044+0000","updated":"2007-10-30T16:42:11.044+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12538854","id":"12538854","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bens","name":"bens","key":"bens","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben Speakmon","active":true,"timeZone":"Etc/UTC"},"body":"I like Henri's second suggestion better. Between that and deprecating the old method, I think everybody's happy :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bens","name":"bens","key":"bens","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben Speakmon","active":true,"timeZone":"Etc/UTC"},"created":"2007-10-30T16:53:49.068+0000","updated":"2007-10-30T16:53:49.068+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12539894","id":"12539894","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Prodding it more - it's \"identityToString\", meaning the identity toString() method; not the appending of the identity to java.lang.String. So the name makes syntactic sense - it's just confusing. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-11-03T07:21:16.266+0000","updated":"2007-11-03T07:21:16.266+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12539896","id":"12539896","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Brain kicks in.... Also, I wouldn't expect:\n\nObjectUtils.appendIdentityToString(buffer, param1)\n                    .appendIdentityToString(buffer, param2)\n                    .appendIdentityToString(buffer, param3); \n\nto even compile. A StringBuffer is returned, not an ObjectUtils. \n\nChaining isn't allowed here, the actual code would have been the very ugly and nested:\n\n            ObjectUtils.appendIdentityToString(\n                ObjectUtils.appendIdentityToString(\n                    ObjectUtils.appendIdentityToString(buffer, param1)\n                    , param2)\n                , param3);\n\nHowever that doesn't end up with a NullPointerException. Instead you get a very nasty bug whereby if param2 is null, then you'll end up with a  StringBuffer just containing the text of param1 - no param3. If you had 'buffer =' on the front, then you just get param3 and no param1. \n\nIdeally the code should be:\n\n* public static String identityToString(Object)\n* public static void appendIdentityToString(StringBuffer, Object)\n\nSod the StringBuffer creation - bet that was only there so the first method could reuse the second. The problem with that is that we don't have overloaded return types. So an alternative would be to deprecate both methods and have:\n\n* public static String identity(Object)\n* public static void appendIdentity(StringBuffer, Object)\n\nThat would allow us to decide if we think a null Object passed in should return the String \"null\" or null in the first case; and result in \"null\" or \"\" in the second. \n\nAlternatively, we could go with an overload of the original name:\n\n* public static String identityToString(Object)\n* public static void identityToString(StringBuffer, Object)\n\nbut that would make the \"null\" bit bad if we do it.\n\nThoughts?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-11-03T07:50:35.566+0000","updated":"2007-11-03T07:59:20.277+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12539897","id":"12539897","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Attaching a patch with the solution originally suggested. It should be pretty close to some of the other options. \n\nA bit more testing should be done on the new methods.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-11-03T08:01:02.431+0000","updated":"2007-11-03T08:01:02.431+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12539914","id":"12539914","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne","name":"scolebourne","key":"scolebourne","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Europe/London"},"body":"Are we not over-thinking this? The method does what it says it does, and is perfectly usable as such.\n\nThis method is meant to simulate the identity toString, which can naturally only be called on a non-null object. If anything, it probably should have thrown an exception for a non-null second argument.\n\nIf you do decide to add a new method, could I suggest considering creating a StringBufferUtils class, with methods similar to StringUtils. appendIdentityToString(StringBuffer, Object) would naturally fit there, and could be defined to append \"null\" if the object is null.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne","name":"scolebourne","key":"scolebourne","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Europe/London"},"created":"2007-11-03T10:48:09.544+0000","updated":"2007-11-03T10:48:09.544+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12540209","id":"12540209","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"The problem with the method lies with the automagical creation. Passing in null should not lead to a StringBuffer being created and then returned - the user should be responsible for their parameters. StringBuffer methods should have void return types. \n\nThe best way to solve that is to deprecate the old StringBuffer method and add a new method of:\n\n* public static void identityToString(StringBuffer, Object) \n\nOne that throws an NPE if the first param is null.\n\nThe second question is what to do in the case of Object being null. Currently the String variant returns null. The new StringBuffer variant could either append \"null\", \"\", or throw an NPE. The old library was effectively appending \"\", so that's the current behaviour. I can see value in all three options, so suggest we stick with the empty String option - ie) nothing happens to the buffer. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-11-05T15:56:57.553+0000","updated":"2007-11-05T15:56:57.553+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12540224","id":"12540224","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pbenedict","name":"pbenedict","key":"pbenedict","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10453","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10453","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10453","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10453"},"displayName":"pbenedict","active":false,"timeZone":"Etc/UTC"},"body":"Stephen says: \"This method is meant to simulate the identity toString\". Based on his words, I concur that passing a null object should throw an exception. \n\nThus I recommend:\n(1) return void to get rid of method chaining \n(2) throw an exception is StringBuffer is null\n(3) throw an exception if Object is null\n\n#3 makes most sense. There is no identity to a null object.\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pbenedict","name":"pbenedict","key":"paul4christ79","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=paul4christ79&avatarId=37065","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=paul4christ79&avatarId=37065","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=paul4christ79&avatarId=37065","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=paul4christ79&avatarId=37065"},"displayName":"Paul Benedict","active":true,"timeZone":"America/Chicago"},"created":"2007-11-05T17:30:29.695+0000","updated":"2007-11-05T17:30:29.695+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12541935","id":"12541935","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Attaching another attempt at this - matches consensus atm.\n\nNew method.\nOld method deprecated.\nThrows NPEs for null input.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-11-12T20:23:15.164+0000","updated":"2007-11-12T20:23:15.164+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12541940","id":"12541940","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bens","name":"bens","key":"bens","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben Speakmon","active":true,"timeZone":"Etc/UTC"},"body":"Looks good. +1.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bens","name":"bens","key":"bens","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ben Speakmon","active":true,"timeZone":"Etc/UTC"},"created":"2007-11-12T20:31:52.010+0000","updated":"2007-11-12T20:31:52.010+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12380853/comment/12541973","id":"12541973","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"svn ci -m \"Applying my second patch from LANG-360 - it seems to do what Stephane/Paul and I are consensing on\" src\n\nSending        src/java/org/apache/commons/lang/ObjectUtils.java\nSending        src/test/org/apache/commons/lang/ObjectUtilsTest.java\nTransmitting file data ..\nCommitted revision 594336.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2007-11-12T22:54:23.428+0000","updated":"2007-11-12T22:54:23.428+0000"}],"maxResults":17,"total":17,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-360/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0d66v:"}}