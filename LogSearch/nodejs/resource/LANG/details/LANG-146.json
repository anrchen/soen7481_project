{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12340462","self":"https://issues.apache.org/jira/rest/api/2/issue/12340462","key":"LANG-146","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310481","id":"12310481","key":"LANG","name":"Commons Lang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310481&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310481&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310481&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310481&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10260","id":"10260","description":"Apache Commons components","name":"Commons"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311706","id":"12311706","description":"","name":"2.0","archived":true,"released":true,"releaseDate":"2003-09-02"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2002-12-19T07:21:47.000+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Mar 24 00:26:51 UTC 2003","customfield_12310420":"34070","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":"2006-05-16T12:44:37.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-146/watchers","watchCount":0,"isWatching":false},"created":"2002-12-17T20:38:22.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"2.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311706","id":"12311706","description":"","name":"2.0","archived":true,"released":true,"releaseDate":"2003-09-02"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-05-16T12:44:37.000+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[],"timeoriginalestimate":null,"description":"The org.apache.commons.lang.enum.Enum class does not support the following\nconstruct of static inner anonymous sub-classed constants:\n\npublic abstract class MyEnum extends Enum {\n\tpublic static final MyEnum ENUM1 = new MyEnum(\"enum1\") {\n\t\tpublic String getValue() {\n\t\t\treturn \"X\";\n\t\t}\n\t};\n\n\tpublic static final MyEnum ENUM2 = new MyEnum(\"enum2\") {\n\t\tpublic String getValue() {\n\t\t\treturn \"Y\";\n\t\t}\n\t};\n\n\t/**\n\t * Constructor.\n\t */\n\tprotected MyEnum(String name) {\n\t\tsuper(name);\n\t}\n\n\t/**\n\t * Returns a value.\n\t * Creation date: (16/12/2002 13:25:35)\n\t */\n\tpublic abstract String getValue();\n}\n\nENUM1 and ENUM2 are assigned anonymous inner class names 'MyEnum$0' and\n'MyEnum$1' respectively instead of the super class 'MyEnum' when added to the\nlist of enumerations kept in the Enum super class via the Enum constructor.\n\nA simple work around is to strip the inner class descriminator off the class\nname  in the Enum constructor, i.e.\n\n    protected Enum(String name) {\n        super();\n        if (name == null || name.length() == 0) {\n            throw new IllegalArgumentException(\"The Enum name must not be empty\");\n        }\n        iName = name;\n\n        // Retrieve class name.\n        String className = getClass().getName();\n\n        // Search for inner class.\n        int index = className.lastIndexOf('$');\n        if (index > -1) {\n                // Strip off inner class reference.\n                className = className.substring(0, index);\n        }\n        \n        Entry entry = (Entry) cEnumClasses.get(className);\n        \n        if (entry == null) {\n            entry = new Entry();\n            cEnumClasses.put(className, entry);\n        }\n        if (entry.map.containsKey(name)) {\n            throw new IllegalArgumentException(\"The Enum name must be unique, '\"\n+ name + \"' has already been added\");\n        }\n        entry.map.put(name, this);\n        entry.list.add(this);\n    }","customfield_10010":15439.0,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12332093","id":"12332093","filename":"ASF.LICENSE.NOT.GRANTED--Enum.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"created":"2003-01-30T00:10:06.000+0000","size":14401,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12332093/ASF.LICENSE.NOT.GRANTED--Enum.java"},{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12332094","id":"12332094","filename":"ASF.LICENSE.NOT.GRANTED--VxsTestEnum.java","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"created":"2003-01-30T00:11:19.000+0000","size":2453,"mimeType":"text/plain","content":"https://issues.apache.org/jira/secure/attachment/12332094/ASF.LICENSE.NOT.GRANTED--VxsTestEnum.java"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"74829","customfield_12312823":null,"summary":"Enum does not support inner sub-classes","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"Operating System: other\nPlatform: PC","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340462/comment/12403366","id":"12403366","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne%40joda.org","name":"scolebourne@joda.org","key":"scolebourne@joda.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Etc/UTC"},"body":"In the example given, it would seem appropriate to add an extra parameter to \nthe constructor:\n\npublic static final MyEnum ENUM1 = new MyEnum(\"enum1\", \"X\");\n\nDoes this solve the problem?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne%40joda.org","name":"scolebourne@joda.org","key":"scolebourne@joda.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Etc/UTC"},"created":"2002-12-19T07:21:47.000+0000","updated":"2002-12-19T07:21:47.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340462/comment/12403367","id":"12403367","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"body":"Yes I agree if the inner sub-class method was just returning a value then\nmodifying the constructor to take in the value would work because no\nsub-classing would be required. My example was probably not the best because I\nwas thinking more along the lines where the static enum definition contained a\nmethod that encapsulated logic other than merely returning a value which would\nrequire sub-classing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"created":"2002-12-19T22:07:33.000+0000","updated":"2002-12-19T22:07:33.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340462/comment/12403368","id":"12403368","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne%40joda.org","name":"scolebourne@joda.org","key":"scolebourne@joda.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Etc/UTC"},"body":"Change made to support functional enums along the lines proposed here. Check \nthe CVS.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne%40joda.org","name":"scolebourne@joda.org","key":"scolebourne@joda.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Etc/UTC"},"created":"2003-01-01T06:46:36.000+0000","updated":"2003-01-01T06:46:36.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340462/comment/12403369","id":"12403369","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"body":"Created an attachment (id=4621)\nPatch Enum class\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"created":"2003-01-30T00:10:06.000+0000","updated":"2003-01-30T00:10:06.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340462/comment/12403370","id":"12403370","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"body":"Created an attachment (id=4622)\nEnum test class\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"created":"2003-01-30T00:11:19.000+0000","updated":"2003-01-30T00:11:19.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340462/comment/12403371","id":"12403371","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"body":"I found a bug with my original very simplisting solution. The follwing is the\ncorrect algorythm to determine the actual enumeration class for a given\nenumeration object which may be defined by an inner class. I've attached the\npatched class and a test class.\n\n// Search for actual enumerated type. This is necessary as enumerated types might\n// be defined by inner classes. The actual enumerated type is defined as the top\ncontainer or\n// declaring class that can be assigned to the actual class of enumeration being\nadded.\nClass clazz = this.getClass();\nwhile (clazz.getDeclaringClass() != null &&     \nclazz.getDeclaringClass().isAssignableFrom(this.getClass())) {\n\tclazz = clazz.getSuperclass();\n}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=chris.webb%40voxsurf.com","name":"chris.webb@voxsurf.com","key":"chris.webb@voxsurf.com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Chris Webb","active":true,"timeZone":"Etc/UTC"},"created":"2003-01-30T00:12:28.000+0000","updated":"2003-01-30T00:12:28.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340462/comment/12403372","id":"12403372","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne%40joda.org","name":"scolebourne@joda.org","key":"scolebourne@joda.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Etc/UTC"},"body":"Regrettably, getDeclaringClass() doesn't function correctly on my JDK141. I \nhave got a version and test code on the CVS for your problem, and also to \nsupport hierarchical Enums now. Perhaps you could test that?\nStephen","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne%40joda.org","name":"scolebourne@joda.org","key":"scolebourne@joda.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Etc/UTC"},"created":"2003-02-05T02:33:28.000+0000","updated":"2003-02-05T02:33:28.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12340462/comment/12403373","id":"12403373","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne%40joda.org","name":"scolebourne@joda.org","key":"scolebourne@joda.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Etc/UTC"},"body":"Closing as I believe fixed in CVS","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=scolebourne%40joda.org","name":"scolebourne@joda.org","key":"scolebourne@joda.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Stephen Colebourne","active":true,"timeZone":"Etc/UTC"},"created":"2003-03-24T00:26:51.000+0000","updated":"2003-03-24T00:26:51.000+0000"}],"maxResults":8,"total":8,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-146/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0d6hz:"}}