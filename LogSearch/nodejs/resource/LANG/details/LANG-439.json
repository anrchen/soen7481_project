{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12397175","self":"https://issues.apache.org/jira/rest/api/2/issue/12397175","key":"LANG-439","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310481","id":"12310481","key":"LANG","name":"Commons Lang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310481&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310481&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310481&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310481&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10260","id":"10260","description":"Apache Commons components","name":"Commons"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12311714","id":"12311714","description":"JDK 1.5 focused version of Lang","name":"3.0","archived":true,"released":true,"releaseDate":"2011-07-19"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12312322":null,"customfield_12310220":"2008-06-09T06:51:58.382+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Sun Jul 19 18:49:34 UTC 2009","customfield_12310420":"34093","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_35872395328_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2009-07-19T18:49:34.932+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-439/watchers","watchCount":0,"isWatching":false},"created":"2008-05-30T14:16:19.604+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12312481","id":"12312481","description":"Bugfix release of the Lang1 codebase","name":"2.4","archived":true,"released":true,"releaseDate":"2008-03-18"}],"issuelinks":[{"id":"12325152","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12325152","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"outwardIssue":{"id":"12425706","key":"LANG-505","self":"https://issues.apache.org/jira/rest/api/2/issue/12425706","fields":{"summary":"Rewrite StringEscapeUtils","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/3","id":"3","description":"A task that needs to be done.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21148&avatarType=issuetype","name":"Task","subtask":false,"avatarId":21148}}}},{"id":"12325430","self":"https://issues.apache.org/jira/rest/api/2/issueLink/12325430","type":{"id":"10030","name":"Reference","inward":"is related to","outward":"relates to","self":"https://issues.apache.org/jira/rest/api/2/issueLinkType/10030"},"inwardIssue":{"id":"12399345","key":"LANG-448","self":"https://issues.apache.org/jira/rest/api/2/issue/12399345","fields":{"summary":"Lower Ascii Characters don't get encoded by Entities.java","status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133}}}}],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2009-12-17T03:41:00.673+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313203","id":"12313203","name":"lang.*"}],"timeoriginalestimate":null,"description":"I encountered this problem when I sent html from the server to a client using AjaxRequest. HTML was escaped wrapped in CDATA. I thought it was pretty safe. See my xml fragment below:\n//------------------------------------------------------------------------------------------\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<ajax-fragment>\n<html-rows>\n<![CDATA[\n<div style=\"padding-left: 1px;\" class=\"columnContent4  column4\">\n<span  column-id=\"Message\"  class=\"cellContent\"  onmouseover=\"w12450823.onDwell(event); w12450823.onCellSelectionOnMouseOver(event);\"  onclick=\"w12450823.onCellSelectionOnClick(event)\"  >May 29 10:48:29 rdia643 su: - 2 nitroqa-nss</span></div>\n]]>\n</html-rows>\n</ajax-fragment>\n//------------------------------------------------------------------------------------------\nHowever in FF2 there was js error:\n//-------------------------------------------------------------------------------------------- \nError: not well-formed\nSource Code:\n<span  column-id=\"Message\"  class=\"cellContent \"  onmouseover=\"w12450823.onDwell(event); w12450823.onCellSelectionOnMouseOver(event); \" onclick=\"w12450823.onCellSelectionOnClick(event)\"  >May 29 10:48:29 rdia643 su: - 2 nitroqa-nss</span></div\n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------^\nI figured out that StringEscapeUtils.escapeHTML() did not escape one of the characters. it was a '\\b'(ascii 8).\nI had to change to org.apache.commons.lang.Entities.excape() method:\npublic void escape(Writer writer, String str) throws IOException {\n\tint len = str.length();\n\tfor (int i = 0; i < len; i++) {\n\t\tchar c = str.charAt(i);\n\t\tString entityName = this.entityName(c);\n\t\tif (entityName == null) {\n\t\t\tif ((c < 0x20 && c != 9 && c != 10 && c != 13) || c >> 0x7F) {\n\t\t\t\twriter.write(\"&#\");\n\t\t\t\twriter.write(Integer.toString(c, 10));\n\t\t\t\twriter.write(';');\n\t\t\t}\n\t\t\telse {\n\t\t\t\twriter.write(c);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\twriter.write('&');\n\t\t\twriter.write(entityName);\n\t\t\twriter.write(';');\n\t\t}\n\t}\n}\n\n//---------------------------------------------------------------------------------------\nIt can be tested with unittest:\n\nimport java.io.Reader;\nimport java.io.StringReader;\n\nimport junit.framework.TestCase;\nimport org.apache.commons.lang.StringEscapeUtils;\nimport org.jdom.input.SAXBuilder;\n\npublic class StringEscapeUtilsTest extends TestCase {\n\npublic void testPR73092() throws Exception {\n\tStringBuilder test = new StringBuilder(50);\n\tfor (int i = 0; i <= 50; i++) {\n\t\ttest.append((char)i);\n\t}\n\n\tStringBuilder result = new StringBuilder(\"<test>\\n<![CDATA[\\n\");\n\tresult.append(StringEscapeUtils.escapeHtml(test.toString()));\n\tresult.append(\"\\n]]>\\n</test>\\n\");\n\n\tvalidate(new StringReader(result.toString()));\n\n\tresult = new StringBuilder(\"<test>\\n<![CDATA[\\n\");\n\tresult.append(test.toString());\n\tresult.append(\"\\n]]>\\n</test>\\n\");\n\n\ttry {\n\t\tvalidate(new StringReader(result.toString()));\n\t\tfail(\"expected to blow up\");\n\t}\n\tcatch (Exception e) {\n\t\t//\n\t}\n}\n\n/** make sure that xml is well-formed */\nprivate static void validate(Reader xmlSource) throws Exception {\n\tSAXBuilder saxBuilder = new SAXBuilder();\n\tsaxBuilder.build(xmlSource);\n}\n\n}\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"74749","customfield_12312823":null,"summary":"StringEscapeUtils.escapeHTML() does not escape chars (0x00-0x20)","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=psivolob","name":"psivolob","key":"psivolob","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pavel Sivolobtchik","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=psivolob","name":"psivolob","key":"psivolob","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pavel Sivolobtchik","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"java5","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12397175/comment/12603482","id":"12603482","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"I thought we'd hit this for escapeXml before and the spec said that such characters were not escaped.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2008-06-09T06:51:58.382+0000","updated":"2008-06-09T06:51:58.382+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12397175/comment/12603496","id":"12603496","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jochen%40apache.org","name":"jochen@apache.org","key":"jochen@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jochen%40apache.org&avatarId=24948","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jochen%40apache.org&avatarId=24948","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jochen%40apache.org&avatarId=24948","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jochen%40apache.org&avatarId=24948"},"displayName":"Jochen Wiedmann","active":true,"timeZone":"Europe/Berlin"},"body":"It is crystal clear, that escapeXml *must* not escape such characters, but should throw an exception.\n\nI haven't got any idea for HTML documents. I'd be in favour for the same handling as XML, though, for practical reasons. Whoever needs these binary characters should use BASE64 or something similar. At least I'd wait for an explicit hint, that escaped 0x00 characters *are* valid in HTML.\n\nHowever, I must admit, that I do not like the current implementation. Simply *ignoring* such characters is, IMO, worse than trying to escape them. IMO, we should throw an exception, if we find characters that we suspect to be invalid.\n\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jochen%40apache.org","name":"jochen@apache.org","key":"jochen@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=jochen%40apache.org&avatarId=24948","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=jochen%40apache.org&avatarId=24948","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=jochen%40apache.org&avatarId=24948","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=jochen%40apache.org&avatarId=24948"},"displayName":"Jochen Wiedmann","active":true,"timeZone":"Europe/Berlin"},"created":"2008-06-09T07:55:35.947+0000","updated":"2008-06-09T07:55:35.947+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12397175/comment/12603569","id":"12603569","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=psivolob","name":"psivolob","key":"psivolob","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pavel Sivolobtchik","active":true,"timeZone":"Etc/UTC"},"body":"actualy 9(tab),10(newline),13(c-return) are valid chars. But only these 3 are valid from the range from 0 to 0x20","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=psivolob","name":"psivolob","key":"psivolob","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pavel Sivolobtchik","active":true,"timeZone":"Etc/UTC"},"created":"2008-06-09T13:57:56.595+0000","updated":"2008-06-09T13:57:56.595+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12397175/comment/12733036","id":"12733036","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Closing as LANG-505 has given the user the ability to customize their escaping, and LANG-515 drives deciding what our standard default pattern should be.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2009-07-19T18:49:34.923+0000","updated":"2009-07-19T18:49:34.923+0000"}],"maxResults":4,"total":4,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-439/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0d607:"}}