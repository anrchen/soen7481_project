{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12501015","self":"https://issues.apache.org/jira/rest/api/2/issue/12501015","key":"LANG-686","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310481","id":"12310481","key":"LANG","name":"Commons Lang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310481&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310481&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310481&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310481&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10260","id":"10260","description":"Apache Commons components","name":"Commons"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12325281","id":"12325281","description":"This issue has a patch that needs to be reviewed","name":"Review Patch","archived":false,"released":false}],"aggregatetimespent":null,"resolution":null,"customfield_12312322":null,"customfield_12310220":"2011-03-10T16:40:09.450+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Tue Apr 03 20:42:10 UTC 2012","customfield_12310420":"3001","customfield_12312320":null,"customfield_12310222":null,"customfield_12312321":null,"resolutiondate":null,"workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-686/watchers","watchCount":0,"isWatching":false},"created":"2011-03-10T13:19:28.249+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"1.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316043","id":"12316043","description":"","name":"2.6","archived":false,"released":true,"releaseDate":"2011-01-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-10-21T05:43:12.513+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/1","description":"The issue is open and ready for the assignee to start work on it.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/open.png","name":"Open","id":"1","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/2","id":2,"key":"new","colorName":"blue-gray","name":"To Do"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313203","id":"12313203","name":"lang.*"}],"timeoriginalestimate":null,"description":"After executing line\n\nStringUtils.replaceEachRepeatedly(\"aaa\", new String[]{\"aa\"}, new String[]{\"aXa\"});\n\nexception is thrown:\n\nException in thread \"main\" java.lang.IllegalStateException: TimeToLive of -1 is less than 0: aXaXa\n\tat org.apache.commons.lang.StringUtils.replaceEach(StringUtils.java:3986)\n\tat org.apache.commons.lang.StringUtils.replaceEach(StringUtils.java:4099)\n\tat org.apache.commons.lang.StringUtils.replaceEach(StringUtils.java:4099)\n\tat org.apache.commons.lang.StringUtils.replaceEachRepeatedly(StringUtils.java:3920)\n\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[{"self":"https://issues.apache.org/jira/rest/api/2/attachment/12521211","id":"12521211","filename":"LANG-686.patch","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tn","name":"tn","key":"tn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Neidhart","active":true,"timeZone":"Europe/Berlin"},"created":"2012-04-03T20:42:10.410+0000","size":11146,"mimeType":"text/x-diff","content":"https://issues.apache.org/jira/secure/attachment/12521211/LANG-686.patch"}],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"63036","customfield_12312823":null,"summary":"StringUtils.replaceEachRepeatedly(\"aaa\", new String[]{\"aa\"}, new String[]{\"aXa\"}); throw an exception","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qed","name":"qed","key":"qed","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"qed","active":true,"timeZone":"Europe/Berlin"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qed","name":"qed","key":"qed","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"qed","active":true,"timeZone":"Europe/Berlin"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"jdk 1.6.24, windows xp pro sp3, eclipse helios","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12501015/comment/13005142","id":"13005142","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maurizio.cucchiara","name":"maurizio.cucchiara","key":"maurizio.cucchiara","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maurizio.cucchiara&avatarId=10373","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maurizio.cucchiara&avatarId=10373","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maurizio.cucchiara&avatarId=10373","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maurizio.cucchiara&avatarId=10373"},"displayName":"Maurizio Cucchiara","active":true,"timeZone":"Europe/London"},"body":"I'm not sure this is a bug. The IllegalStateException was throwned because your substitution pattern triggers a (though little) recursion, it's a kind of prevention, in order to avoid StackOverflowError","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maurizio.cucchiara","name":"maurizio.cucchiara","key":"maurizio.cucchiara","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=maurizio.cucchiara&avatarId=10373","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=maurizio.cucchiara&avatarId=10373","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=maurizio.cucchiara&avatarId=10373","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=maurizio.cucchiara&avatarId=10373"},"displayName":"Maurizio Cucchiara","active":true,"timeZone":"Europe/London"},"created":"2011-03-10T16:40:09.450+0000","updated":"2011-03-10T16:40:09.450+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12501015/comment/13005226","id":"13005226","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qed","name":"qed","key":"qed","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"qed","active":true,"timeZone":"Europe/Berlin"},"body":"I solved this problem by making this call instead:\n\nStringUtils.replaceEachRepeatedly(\"aaa\", new String[]{\"aa\", \"\"}, new String[]{\"aXa\", \"\"});\n\nMaybe there should be a limit to number of iterations or something similar. I didn't know that this function is not supposed to support recursion. I think this function is good suited when (java) regex fail in matching already replaced part of string and hence it shouldn't be dicouraged to use this function as a solution imho.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qed","name":"qed","key":"qed","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"qed","active":true,"timeZone":"Europe/Berlin"},"created":"2011-03-10T18:32:01.727+0000","updated":"2011-03-10T18:32:01.727+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12501015/comment/13007341","id":"13007341","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"At the very least the exception could explain what the problem is rather than what the state of an obscure private variable is.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-03-16T04:00:06.685+0000","updated":"2011-03-16T04:00:06.685+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12501015/comment/13071526","id":"13071526","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Digging into this, the search should have been:\n\n\"aaa\"\n\"aXaa\"\n\"aXaXa\"\n\nWhich is hardly the deepest loop.\n\nThe TTL would have been 1, ie) the length of the inputted String[] { \"aXa\" }.\n\nI wonder if the issue is that TTL needs to be longer (which is what qed did by adding extra \"\"s).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-07-27T05:43:11.667+0000","updated":"2011-07-27T05:43:11.667+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12501015/comment/13071533","id":"13071533","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"For this regexp; and I suspect it's the worst, yet vaguely sane, case; the TTL would have needed to have been text.length() - 1. For large text that's going to offer no protection against StackOverflowError. Options would seem to be:\n\n1) Leave as is, improve IllegalStateException message (and update in javadoc which says IllegalArgumentException).\n2) Stop protecting against StackOverflowError.\n3) Increase the size by a marginal, yet arbitrary, amount.\n\nI'm going to continue to go with #1.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-07-27T05:56:39.373+0000","updated":"2011-07-27T05:56:39.373+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12501015/comment/13071554","id":"13071554","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Improved error message added (I hope):\n\n\"Output of one loop is the input of another; protecting from potential StackOverflowError\"\n\nI think there is value in #3 above as well. Some arbitrarily small number to be a minimum TTL. ","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-07-27T06:35:53.411+0000","updated":"2011-07-27T06:35:53.411+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12501015/comment/13071603","id":"13071603","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"body":"The message is ambiguous; protecting could refer to the first part of the sentence rather than the exception itself.\n\nHow about\n\n\"Aborting to protect against StackOverflowError - output of one loop is the input of another\"","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"created":"2011-07-27T08:55:07.506+0000","updated":"2011-07-27T08:55:07.506+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12501015/comment/13071774","id":"13071774","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qed","name":"qed","key":"qed","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"qed","active":true,"timeZone":"Europe/Berlin"},"body":"> output of one loop is the input of another\nAnd that's a problem? That's how grammars are working. I don't think that this function should prevent such behaviour (ie. output of one loop should be allowed to be input of another loop).","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=qed","name":"qed","key":"qed","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"qed","active":true,"timeZone":"Europe/Berlin"},"created":"2011-07-27T14:50:37.903+0000","updated":"2011-07-27T14:50:37.903+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12501015/comment/13072569","id":"13072569","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Sebb: I've changed to your suggested text (r1152021).\n\nqed: Not disagreeing. For 3.0.1, improving the error message to avoid your 'WTF???' is an improvement. Whether we simply strip out the TTL code and let the StackOverflowError happen is another question. My personal feeling is in line with yours (I think). That is - \"let it happen\".","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-07-28T22:23:35.316+0000","updated":"2011-07-28T22:23:35.316+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12501015/comment/13076074","id":"13076074","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Moving to 3.0.2. Note that the error message was improved and javadoc Exceptions fixed in 3.0.1. When resolving, make 3.0.1 a fix version as well.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2011-08-02T07:22:03.872+0000","updated":"2011-08-02T07:22:03.872+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12501015/comment/13245710","id":"13245710","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tn","name":"tn","key":"tn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Neidhart","active":true,"timeZone":"Europe/Berlin"},"body":"I have worked on this a bit and provide a patch that does the following:\n\n * refactor the replaceEach method to avoid code duplication\n * change loop detection code\n\nInstead of using a timeToLive variable that tries to detect infinite loops, I used a quite simple but effective method:\n\nWhenever at the end of a replace cycle we end up having a result string that has already be seen so far, we have possibly detected an infinite loop and thus abort the execution (with an exception as before).\n\nI have also added two additional unit test cases.\n\nEdit:\n\nThe new loop detection code does not prevent stackoverflow exceptions of course. But as others have pointed out, just let it happen (it is anyway very unlikely to occur, need to come up with a test case for it somehow). I would prefer correct behavior in normal cases, and a robust loop detection for recursive/weird cases.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tn","name":"tn","key":"tn","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Thomas Neidhart","active":true,"timeZone":"Europe/Berlin"},"created":"2012-04-03T20:42:10.493+0000","updated":"2012-04-04T13:38:43.674+0000"}],"maxResults":11,"total":11,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-686/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0b5pb:"}}