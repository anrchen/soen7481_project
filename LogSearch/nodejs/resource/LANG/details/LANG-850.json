{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12615001","self":"https://issues.apache.org/jira/rest/api/2/issue/12615001","key":"LANG-850","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310481","id":"12310481","key":"LANG","name":"Commons Lang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310481&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310481&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310481&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310481&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10260","id":"10260","description":"Apache Commons components","name":"Commons"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/8","id":"8","description":"The described issue is not actually a problem - it is as designed.","name":"Not A Problem"},"customfield_12312322":null,"customfield_12310220":"2012-11-06T22:22:22.968+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Wed Oct 16 08:50:07 UTC 2013","customfield_12310420":"255523","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_29686248530_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2013-10-16T08:50:07.263+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-850/watchers","watchCount":2,"isWatching":false},"created":"2012-11-06T18:39:18.799+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.svg","name":"Minor","id":"4"},"labels":["patch"],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12317550","id":"12317550","description":"November release from 3.x","name":"3.1","archived":false,"released":true,"releaseDate":"2011-11-14"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2013-10-16T08:50:07.324+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313196","id":"12313196","name":"lang.time.*"}],"timeoriginalestimate":null,"description":"The method truncatedCompareTo doesn't work properly when comparing 2 calendars in a different timezone (when one of them is \"America/Montevideo\", the same as the machine running the test).\nHere is the sample code to reproduce.\nThe Timezone of the computer has to be set to UTC-3 Montevideo, with DST.\n{quote}\nGregorianCalendar c1 = new GregorianCalendar(2012,10,6);\nSystem.out.println(\"The time: \" + c1.getTime());\n\nc1.setTimeZone(TimeZone.getTimeZone(\"America/Montevideo\"));\nCalendar truncate1 =  DateUtils.truncate(c1, Calendar.MONTH);\nSystem.out.println(\"America/Montevideo then truncated: \" + truncate1.getTime());\n\nGregorianCalendar c2 = new GregorianCalendar(2012,10,6);\nc2.setTimeZone(TimeZone.getTimeZone(\"GMT\"));\nCalendar truncate2 = DateUtils.truncate(c2, Calendar.MONTH);\nSystem.out.println(\"GMT then truncated: \" + truncate2.getTime());\n\t\t\nSystem.out.println(\"Truncated compare: \" + DateUtils.truncatedCompareTo(c1, c2, Calendar.MONTH));\n{quote}\nThe output:\n{quote}\nThe time: Tue Nov 06 00:00:00 UYST 2012\nAmerica/Montevideo then truncated: Thu Nov 01 00:00:00 UYST 2012\nGMT then truncated: Wed Oct 31 22:00:00 UYST 2012\nTruncated compare: 1\n{quote}\n\nA suggestion is to change the TimeZone of both calendars before truncating. For example, setting both to TimeZone.getDefault().\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"84387","customfield_12312823":null,"summary":"DateUtils.truncatedCompareTo not working properly with DST timezones","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rsisto","name":"rsisto","key":"rsisto","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rafael Sisto","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rsisto","name":"rsisto","key":"rsisto","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rafael Sisto","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":"java version \"1.6.0_32\"\nWindows 7\nTimezone: America/Montevideo","customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12615001/comment/13491885","id":"13491885","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"body":"I'm not sure what the issue is here: the two calendars objects are not the same, because they have different TimeZones.\n\nThis seems to be more about how calendar objects behave when their timezone is changed.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"created":"2012-11-06T22:22:22.968+0000","updated":"2012-11-06T22:22:22.968+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12615001/comment/13492034","id":"13492034","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rsisto","name":"rsisto","key":"rsisto","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rafael Sisto","active":true,"timeZone":"Etc/UTC"},"body":"I agree with that (the objects aren't the same), but shouldn't the months of both calendars match? Which is the same as saying that the last line should return 0, right?\n\nAs a clear example, the month of 11-6-2012 (GMT-3) is the same as the month of 11-20-2012 (GMT-7), right? \nWhat am I thinking wrong here?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rsisto","name":"rsisto","key":"rsisto","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rafael Sisto","active":true,"timeZone":"Etc/UTC"},"created":"2012-11-07T01:23:48.770+0000","updated":"2012-11-07T01:23:48.770+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12615001/comment/13492068","id":"13492068","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"body":"AFAICT, the problem arises in your test because the calendar objects are created with the default timezone and the timezone is then changed.\n\nIf you change the default timezone before creating the calendar objects, then they truncate as expected.\nHowever they still won't be equal because of the time zone difference.\n\nI'm also not clear what the use case is here.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=sebb%40apache.org","name":"sebb@apache.org","key":"sebb@apache.org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sebb","active":true,"timeZone":"Etc/GMT"},"created":"2012-11-07T02:17:00.804+0000","updated":"2012-11-07T02:17:00.804+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12615001/comment/13492091","id":"13492091","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rsisto","name":"rsisto","key":"rsisto","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rafael Sisto","active":true,"timeZone":"Etc/UTC"},"body":"Thanks for clearing that, so the method truncates taking account of the current timezone of the calendar.\n\nI was having problems when comparing:\n1-an XMLGregorianCalendar converted to Calendar (XMLGregorianCalendar doesn't have the concept of DST, so the timezone is converted to GMT-2 in this timezone) with\n2-a GregorianCalendar created with \"new GregorianCalendar()\" which has a timezone of \"America/Montevideo\".\n\nAccording to the comments, my code should set the timezone of the converted XMLGregorianCalendar to America/Montevideo before using the truncate method.\n\nThanks again, I had thought that the truncatedCompareTo should compare dates managing the timezone before comparing.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rsisto","name":"rsisto","key":"rsisto","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rafael Sisto","active":true,"timeZone":"Etc/UTC"},"created":"2012-11-07T03:16:41.849+0000","updated":"2012-11-07T03:16:41.849+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12615001/comment/13796573","id":"13796573","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Looks like this conversation was resolved :)","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-10-16T08:50:07.288+0000","updated":"2013-10-16T08:50:07.288+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-850/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0esj3:"}}