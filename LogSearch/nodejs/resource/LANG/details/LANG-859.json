{"expand":"renderedFields,names,schema,operations,editmeta,changelog,versionedRepresentations","id":"12617127","self":"https://issues.apache.org/jira/rest/api/2/issue/12617127","key":"LANG-859","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype","name":"Bug","subtask":false,"avatarId":21133},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/12310481","id":"12310481","key":"LANG","name":"Commons Lang","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=12310481&avatarId=10011","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310481&avatarId=10011","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310481&avatarId=10011","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310481&avatarId=10011"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10260","id":"10260","description":"Apache Commons components","name":"Commons"}},"fixVersions":[],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/2","id":"2","description":"The problem described is an issue which will never be fixed.","name":"Won't Fix"},"customfield_12312322":null,"customfield_12310220":"2012-11-21T19:48:07.374+0000","customfield_12312520":null,"customfield_12312323":null,"customfield_12312521":"Mon Dec 26 16:40:18 UTC 2016","customfield_12310420":"259327","customfield_12312320":null,"customfield_12310222":"1_*:*_1_*:*_129255572126_*|*_6_*:*_1_*:*_0","customfield_12312321":null,"resolutiondate":"2016-12-26T16:40:18.100+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312923":null,"customfield_12312326":null,"customfield_12312920":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312921":null,"customfield_12312324":null,"customfield_12312720":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-859/watchers","watchCount":5,"isWatching":false},"created":"2012-11-21T16:20:46.327+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/3","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/major.svg","name":"Major","id":"3"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12313422":"false","customfield_12310310":"0.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"customfield_12311120":null,"customfield_12312330":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/12316043","id":"12316043","description":"","name":"2.6","archived":false,"released":true,"releaseDate":"2011-01-17"}],"issuelinks":[],"customfield_12312339":null,"assignee":null,"customfield_12312337":null,"customfield_12312338":null,"updated":"2016-12-26T16:40:18.442+0000","customfield_12312335":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Done"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/12313203","id":"12313203","name":"lang.*"}],"timeoriginalestimate":null,"description":"According to specification of XML version 1.0 there are Unicode characters that are not allowed in the content of the XML document http://www.w3.org/TR/xml/#charsets\nStringEscapeUtils.escapeXml(value) should escape such characters as &#x<hex-code>; or &#<dec-code>;\n\n{code}\npublic static void main(String[] args) throws Exception {\n    String xmlValidText = \"good\";\n    // Passes assertion\n    assertEquals(StringEscapeUtils.escapeXml(\"good\"), \"good\");\n    \n    char xmlInvalidChar = (char) 0x2;\n    String xmlInvalidText = String.valueOf(xmlInvalidChar);\n    // Fails assertion\n    assertEquals(StringEscapeUtils.escapeXml(xmlInvalidText), \"&#x2;\");\n    \n    System.out.println(\"Is valid: \" + org.apache.xerces.util.XMLChar.isInvalid(xmlInvalidChar));\n    String xml =\n            \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\" +\n            \"<chars>\" +\n            \"<valid>\" + StringEscapeUtils.escapeXml(xmlValidText) + \"</valid>\" +\n            \"<invalid>\" + StringEscapeUtils.escapeXml(xmlInvalidText) + \"</invalid>\" +\n            \"</chars>\";\n    // An invalid XML character (Unicode: 0x2) was found in the element content of the document\n    Document document = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(new ByteArrayInputStream(xml.getBytes(\"UTF-8\")));\n    System.out.println(document);\n}\n{code}\n","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"attachment":[],"aggregatetimeestimate":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12312022":null,"customfield_12310921":null,"customfield_12310920":"124600","customfield_12312823":null,"summary":"StringEscapeUtils.escapeXml doesn't escape chars which are considered invalid according to W3C specification","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tazija","name":"tazija","key":"tazija","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Bushik","active":true,"timeZone":"Etc/UTC"},"subtasks":[],"customfield_12310291":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tazija","name":"tazija","key":"tazija","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Bushik","active":true,"timeZone":"Etc/UTC"},"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"customfield_12311024":null,"environment":null,"customfield_12313520":null,"customfield_12311020":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/12617127/comment/13502104","id":"13502104","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tazija","name":"tazija","key":"tazija","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Bushik","active":true,"timeZone":"Etc/UTC"},"body":"Fixed org.apache.commons.lang.Escape.escape() method for XML    \n\n{code}\n    protected void escape(Writer writer, String text) throws IOException {\n        int len = text.length();\n        for (int i = 0; i < len; i++) {\n            char c = text.charAt(i);\n            String entity = entityName(c);\n            if (entity == null) {\n                // TODO: notice escaping for invalid characters added\n                if (c > 0x7F || XMLChar.isInvalid(c)) {\n                    writer.write(\"&#\");\n                    writer.write(Integer.toString(c, 10));\n                    writer.write(';');\n                } else {\n                    writer.write(c);\n                }\n            } else {\n                writer.write('&');\n                writer.write(entity);\n                writer.write(';');\n            }\n        }\n    }\n{code}","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=tazija","name":"tazija","key":"tazija","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Sergey Bushik","active":true,"timeZone":"Etc/UTC"},"created":"2012-11-21T16:31:29.725+0000","updated":"2012-11-21T16:32:57.290+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12617127/comment/13502246","id":"13502246","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=garydgregory","name":"garydgregory","key":"garydgregory","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=garydgregory&avatarId=16828","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=garydgregory&avatarId=16828","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=garydgregory&avatarId=16828","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=garydgregory&avatarId=16828"},"displayName":"Gary Gregory","active":true,"timeZone":"America/Denver"},"body":"In version 3.x, you can do:\n\n{code:java}\n    @Test\n    public void testEscapeXmlAllCharacters() {\n        // http://www.w3.org/TR/xml/#charsets says:\n        // Char ::= #x9 | #xA | #xD | [#x20-#xD7FF] | [#xE000-#xFFFD] | [#x10000-#x10FFFF] /* any Unicode character,\n        // excluding the surrogate blocks, FFFE, and FFFF. */\n        CharSequenceTranslator escapeXml = StringEscapeUtils.ESCAPE_XML\n                .with(NumericEntityEscaper.below(9), NumericEntityEscaper.between(0xB, 0xC), NumericEntityEscaper.between(0xE, 0x19),\n                        NumericEntityEscaper.between(0xD800, 0xDFFF), NumericEntityEscaper.between(0xFFFE, 0xFFFF), NumericEntityEscaper.above(0x110000));\n\n        assertEquals(\"&#0;&#1;&#2;&#3;&#4;&#5;&#6;&#7;&#8;\", escapeXml.translate(\"\\u0000\\u0001\\u0002\\u0003\\u0004\\u0005\\u0006\\u0007\\u0008\"));\n        assertEquals(\"\\t\", escapeXml.translate(\"\\t\")); // 0x9\n        assertEquals(\"\\n\", escapeXml.translate(\"\\n\")); // 0xA\n        assertEquals(\"&#11;&#12;\", escapeXml.translate(\"\\u000B\\u000C\"));\n        assertEquals(\"\\r\", escapeXml.translate(\"\\r\")); // 0xD\n        assertEquals(\"Hello World!\", escapeXml.translate(\"Hello World!\"));\n    }\n{code}\n\nSee testEscapeXmlAllCharacters in https://svn.apache.org/repos/asf/commons/proper/lang/trunk/src/test/java/org/apache/commons/lang3/StringEscapeUtilsTest.java","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=garydgregory","name":"garydgregory","key":"garydgregory","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=garydgregory&avatarId=16828","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=garydgregory&avatarId=16828","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=garydgregory&avatarId=16828","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=garydgregory&avatarId=16828"},"displayName":"Gary Gregory","active":true,"timeZone":"America/Denver"},"created":"2012-11-21T19:48:07.374+0000","updated":"2012-11-21T19:52:18.869+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12617127/comment/13594313","id":"13594313","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"body":"Despite that, should the ESCAPE_XML change to cover these?","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bayard","name":"bayard","key":"bayard","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Henri Yandell","active":true,"timeZone":"America/Los_Angeles"},"created":"2013-03-06T03:43:31.394+0000","updated":"2013-03-06T03:43:31.394+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12617127/comment/13594464","id":"13594464","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=joehni","name":"joehni","key":"joehni","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=joehni&avatarId=36575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=joehni&avatarId=36575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=joehni&avatarId=36575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=joehni&avatarId=36575"},"displayName":"Joerg Schaible","active":true,"timeZone":"Europe/Berlin"},"body":"Or introduce ESCAPE_XML_1_0 and ESCAPE_XML_1_1, since the valid charstet is different between the two specs.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=joehni","name":"joehni","key":"joehni","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?ownerId=joehni&avatarId=36575","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=joehni&avatarId=36575","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=joehni&avatarId=36575","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=joehni&avatarId=36575"},"displayName":"Joerg Schaible","active":true,"timeZone":"Europe/Berlin"},"created":"2013-03-06T07:35:53.233+0000","updated":"2013-03-06T07:35:53.233+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/12617127/comment/15778625","id":"15778625","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pascalschumacher","name":"pascalschumacher","key":"pascalschumacher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pascal Schumacher","active":true,"timeZone":"Europe/Berlin"},"body":"I'm closing this issue as \"Won't Fix\", because StringEscapeUtils#escapeXml was deprecated almost three years ago and replaced by escapeXml10 and escapeXml11.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=pascalschumacher","name":"pascalschumacher","key":"pascalschumacher","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Pascal Schumacher","active":true,"timeZone":"Europe/Berlin"},"created":"2016-12-26T16:40:18.244+0000","updated":"2016-12-26T16:40:18.244+0000"}],"maxResults":5,"total":5,"startAt":0},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/LANG-859/votes","votes":0,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i0lodr:"}}